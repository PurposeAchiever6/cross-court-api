<% if user_sessions_by_team.blank? %>
  <div>
    No users arrived yet. Check in the players who arrived in the panel below and will appear here
  </div>
<% else %>
  <table class='table-user-sessions-checked-in'>
    <tr>
      <th>#</th>
      <th>User</th>
      <th>First Session</th>
      <th>Status</th>
      <th>Vaccine</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <% user_sessions_by_team.each do |team, user_sessions| %>
      <tbody class=<%= "#{team.present? ? "session-team-#{team}" : 'session-no-team'}" %>>
        <% user_sessions.each_with_index do |user_session, index| %>
          <%= form_with(url: update_user_session_admin_session_path(id: resource.id,
                                                                    date: date,
                                                                    user_session_id: user_session.id),
                        local: true) do %>
            <tr>
              <td>
                <%= "##{index + 1}" if team.present? %>
              </td>
              <td>
                <%= link_to user_session.user_full_name, admin_user_path(user_session.user_id) %>
              </td>
              <td>
                <%= status_tag user_session.is_free_session %>
              </td>
              <td>
                <%= user_session.state.humanize %>
              </td>
              <td>
                <%= user_session.user_vaccinated ? 'Yes' : 'No' %>
              </td>
              <td>
                <div class='flex items-center'>
                  <%= check_box_tag(:checked_in,
                                    true,
                                    user_session.checked_in,
                                    id: "checked_in-#{user_session.id}",
                                    class: 'mr-1') %>
                  <%= label_tag("checked_in-#{user_session.id}", 'Check In User') %>
                </div>
              </td>
              <td>
                <div class='flex items-center'>
                  <%= check_box_tag(:jersey_rental,
                                    true,
                                    user_session.jersey_rental,
                                    id: "jersey_rental-#{user_session.id}",
                                    class: 'mr-1') %>
                  <%= label_tag("jersey_rental-#{user_session.id}",
                                "Jersey Rental - (#{number_to_currency(jersey_rental_price)})") %>
                </div>
              </td>
              <td>
                <div class='flex items-center'>
                  <%= label_tag(:assigned_team, 'Assign team:', class: 'mr-2') %>
                  <%= select_tag(:assigned_team,
                                  options_for_select(['light', 'dark'], user_session.assigned_team),
                                  include_blank: true) %>
                </div>
              </td>
              <td>
                <%= submit_tag('Update', data: { disable_with: 'Loading...' }) %>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    <% end %>
  </table>
<% end %>
